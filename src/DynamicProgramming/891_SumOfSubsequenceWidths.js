/*
Given an array of integers A, consider all non-empty subsequences of A.

For any sequence S, let the width of S be the difference between the maximum and minimum element of S.

Return the sum of the widths of all subsequences of A. 

As the answer may be very large, return the answer modulo 10^9 + 7.

 

Example 1:

Input: [2,1,3]
Output: 6
Explanation:
Subsequences are [1], [2], [3], [2,1], [2,3], [1,3], [2,1,3].
The corresponding widths are 0, 0, 0, 1, 1, 2, 2.
The sum of these widths is 6.
 

Note:

1 <= A.length <= 20000
1 <= A[i] <= 20000
*/

var sumSubseqWidths = function (A) {
  const mod = 10 ** 9 + 7;

  A.sort((a, b) => a - b);

  let sumWidths = 0;
  let last = 0;
  let lastCount = 1;

  for (let i = 1; i < A.length; i += 1) {
    const change = A[i] - A[i - 1];
    const current = (2 * last + change * 2 * lastCount - change) % mod;
    sumWidths = (sumWidths + current) % mod;
    last = current;
    lastCount = (lastCount * 2) % mod;
  }

  return sumWidths;
};

/*
[1]           0

[1, 2]        1
[2]           0

[1, 3]        2
[1, 2, 3]     2
[2, 3]        1
[3]           0

[1, 4]        3
[1, 2, 4]     3
[1, 3, 4]     3
[1, 2, 3, 4]  3
[2, 4]        2
[2, 3, 4]     2
[3, 4]        1
[4]           0

[1, 6]            5
[1, 2, 6]         5
[1, 3, 6]         5
[1, 2, 3, 6]      5
[1, 4, 6]         5
[1, 2, 4, 6]      5
[1, 3, 4, 6]      5
[1, 2, 3, 4, 6]   5
[2, 6]            4
[2, 4, 6]         4
[2, 3, 4, 6]      4
[2, 3, 6]         4
[3, 6]            3
[3, 4, 6]         3
[4, 6]            2
[6]               0

[1, 4]            3
[1, 2, 4]         3
[1, 3, 4]         3
[1, 2, 3, 4]      3
[1, 4, 4]         3
[1, 2, 4, 4]      3
[1, 3, 4, 4]      3
[1, 2, 3, 4, 4]   3
[2, 4]            2
[2, 4, 4]         2
[2, 3, 4, 4]      2
[2, 3, 4]         2
[3, 4]            1
[3, 4, 4]         1
[4, 4]            0
[4]               0


[66, 34, 56, 68],

[34]              0

[34, 56]          22
[56]              0

[34, 66]          32
[34, 56, 66]      32
[56, 66]          10
[66]              0

[34, 68]          34
[34, 56, 68]      34
[56, 68]          12
[34, 66, 68]      34
[34, 56, 66, 68]  34
[56, 66, 68]      12
[66, 68]          2
[68]              0
*/

// const maxLen = 75;
// for (let i = 0; i < 30; i += 1) {
//   const len = Math.floor(Math.random() * maxLen) + 1;

//   const nums = new Array(len).fill(0)
//     .map(() => Math.floor(Math.random() * 100) + 1);

//   // logOutList('"' + s + '",')
//   // logOutList(printRow([len, edges]) + ',')
//   logOutList(printRow(nums) + ',');
//   // logOutList(n);
//   // logOutList(printRow(actions) + '],')
// }

const tests = [
  [2, 1, 3],
  [2, 4, 1, 3],
  [2, 4, 5, 1, 3],
  [2, 4, 6, 1, 3],
  [2, 4, 4, 1, 3],
  [66, 75, 64, 34, 96, 75, 11, 7, 85, 31, 40, 13, 88, 84, 8, 68, 23, 11, 59, 38, 42, 79, 32, 5, 87, 24],
  [61, 33, 27, 28, 37, 56, 32, 6, 5, 22, 78, 76, 6, 88, 37, 38, 23, 85, 56, 14, 10, 94, 10, 4, 73, 9, 25, 84, 39, 7, 64, 43, 41, 55, 85, 43, 19, 97, 45, 100, 48, 10, 12, 38, 76, 100, 27],
  [51, 41, 43, 40, 84, 75, 87, 66, 33, 70, 76, 59, 62, 32, 47, 16, 95, 20, 84, 33, 14, 74],
  [53, 88, 30, 32, 51, 97, 3, 37, 32, 75, 35, 35, 37, 79, 46, 24, 84, 67, 60, 67, 46, 33, 13, 71, 96, 70, 89, 28, 66, 42, 83, 18, 60, 28, 80, 38, 88, 43, 62, 31, 82, 30, 68, 35, 57, 18, 15, 28, 86, 81, 47, 86, 17, 7, 54, 33, 97, 39, 85, 80, 29, 58, 52, 76],
  [54, 93, 68, 80, 44, 36, 36, 60, 8, 92, 21, 76, 91, 64, 28, 64, 80, 78, 57, 64, 77, 16, 66, 16, 59, 75, 86, 63, 77, 97, 24, 12, 69, 64, 73, 97, 35, 56, 45, 7, 10, 22, 80, 61, 3, 92, 19, 98, 8, 58, 93, 40, 3, 50, 14, 90, 30, 84, 14, 64, 59, 16, 24, 72, 23, 74, 56, 28, 13, 64],
  [65, 33, 5, 87, 83, 15, 20, 49, 23, 3, 68, 4, 34, 51, 46, 48, 14, 52, 96, 23, 4, 53, 28, 14, 86, 10, 97, 50, 39, 51, 34, 9, 96, 55, 54, 3, 36, 88, 28, 25, 38, 27, 15, 88, 23],
  [66, 34, 56, 68],
  [48, 19, 42, 42, 8, 12, 55, 98, 43, 65, 38, 58, 29, 12, 17, 30, 53, 58, 12, 62, 83, 65, 7, 48, 17, 63, 82, 32, 15, 6, 2, 59, 40, 51, 86, 19, 15, 54, 9, 24, 79, 92, 50, 44, 67, 61, 16, 37, 6, 9, 48, 54, 84, 77, 34, 81, 14, 69, 61, 82, 26, 3, 96, 36, 63, 18, 15, 85],
  [78],
  [41, 26, 13, 18, 91, 87, 30, 68, 40, 95, 65, 36, 89, 92, 84, 58, 53, 48, 90, 11, 54, 23, 87, 85, 54, 81, 41, 78, 57, 81, 14, 73, 48, 2, 75, 31, 46, 40, 78, 6, 92, 78, 75, 56, 58, 83, 66, 40, 49, 61, 17, 38, 36, 89, 54, 13, 38, 87, 39, 1, 24, 85, 14, 24, 87, 37],
  [98, 36, 1, 91, 39, 76, 26, 83, 98, 87, 70, 39, 56, 23, 60, 64, 42, 88, 75, 7, 43, 83, 99, 6, 24, 50, 34, 85, 56, 45, 95],
  [60, 23, 54, 17, 67, 82, 43, 62, 91, 87, 95, 15, 49, 75, 83, 3, 58, 75, 11, 4, 62, 39, 79],
  [43, 100, 53, 20, 30, 15, 5, 74, 49, 36, 3, 13, 23, 59, 32, 72, 32, 51, 56],
  [80, 60, 98, 73, 17, 68, 9, 6, 64, 43, 7, 15, 42, 7, 61, 22, 34, 56, 66, 73, 81, 90],
  [74, 57, 87, 61, 74, 38, 41, 91, 35, 3, 3, 53, 43, 20, 62, 27, 2, 49, 45, 46, 8, 59, 98, 9, 75, 58, 40, 42, 43, 78, 64, 60, 47, 57, 29, 71, 92, 46],
  [25, 9, 42, 31, 11, 22, 21, 55, 36, 81, 25, 91, 12, 38, 81, 52, 73, 79, 60, 92, 40, 83, 61, 57, 53, 60, 33, 53, 51, 98, 94, 39, 66, 96, 18, 33, 64, 39, 93, 31, 6, 20, 97, 22, 76, 22, 50, 87, 85, 24, 51, 95, 31, 66],
  [36, 28, 9, 69, 19, 56, 74, 1, 65, 94, 88, 33, 32, 58, 1, 5, 88, 11, 30, 81, 8, 44, 38, 71, 75, 73, 77, 42, 25, 40, 13, 3, 48, 55, 93, 98, 30, 29, 78],
  [54, 35, 12, 36, 37, 23, 93, 79, 11, 86, 46, 91, 21, 64, 94, 100, 38],
  [38, 90, 43, 90, 68, 49, 59, 80, 61, 87, 65],
  [93, 34, 78, 19, 9, 95, 17, 55, 38, 60, 24, 54, 94, 50, 8, 48, 64, 27, 88, 84, 29, 23, 90, 59, 29, 24, 53, 81, 67, 88, 95, 14, 98, 77, 95, 78, 44, 53],
  [33, 44, 83, 46, 93, 23, 31, 60, 64, 60, 12, 54, 25, 70, 33, 57, 77, 73, 19, 96, 76, 26, 91, 54, 43, 30, 4, 40, 31, 21, 89, 42, 77, 62, 5, 96],
  [91, 69, 7, 91, 85, 9, 28, 63, 29, 43, 91, 95, 21],
  [71, 44, 97, 5, 84, 99, 58, 84, 87, 83, 5, 54, 31, 88, 84, 22, 57, 71, 52, 57, 35, 24, 31, 18, 37, 21, 76, 70, 40, 27, 67, 47, 1, 33, 97, 32, 93, 39, 73, 36, 27, 28, 10, 92, 13, 7, 19, 65, 16, 91, 67, 4, 72, 57, 48, 10, 58, 99],
  [98, 19, 34, 39, 61, 95, 26, 94, 45, 78, 91, 45],
  [50, 78, 28, 84, 21],
  [34, 43, 57, 69, 82, 88, 6, 4, 50, 18, 8, 26, 51, 45, 72, 44, 13, 34, 100, 77, 42, 69, 24, 90, 39, 15, 2, 69, 31, 96, 49, 86, 95, 56, 3, 68, 34, 67, 19, 52, 39, 47, 90, 51, 97, 79, 51, 42, 63, 49, 93, 75, 76, 87, 91, 37, 21, 64, 29, 39, 88, 15, 14, 33],
  [12, 90, 77, 73, 87, 6, 83, 75, 49, 56, 63, 88, 40, 56, 81, 45, 31, 97, 69, 24, 38, 3, 87, 68, 63, 27, 55, 1, 16, 15, 80, 40, 8, 23, 33, 22, 32, 70, 28, 7, 19, 60, 77, 62, 40, 72, 48, 75, 1, 1, 64, 39, 46],
  [10, 92, 85, 78, 20, 32, 93, 98, 51, 81, 78, 49, 74, 73, 75, 100, 33, 88, 95, 69, 52, 54, 97, 88, 9, 42, 20, 17, 8, 36, 73, 56, 50, 67, 91, 53, 78, 93, 36, 19, 61, 6, 69, 40, 13, 84, 29, 10, 95, 19, 58, 56, 31, 41, 14, 33, 27, 74, 53],
  [18, 23, 72, 13, 20, 48, 28, 71, 16, 82, 60, 21, 3, 94, 10, 24, 9, 81, 75, 95, 81, 66, 77, 68, 46, 8, 92],
  [73, 62, 43, 56, 78, 87, 44, 2, 92, 88, 34, 74, 73, 70, 90, 57, 65, 36, 12, 81, 13, 91, 40, 43, 32, 54, 60, 3, 4, 65, 72, 73, 78, 62, 42, 28, 8, 57, 63, 69, 19, 13, 66, 11, 63, 47, 74, 95, 63, 55, 17, 29, 99],
];

let i = 0;
for (let test of tests) {
  console.time(i);
  logOutList(sumSubseqWidths(test));
  // logOutList(printRow(braceExpansionII(test)) + ',');
  // logOutList(printRow(intersectionSizeTwo(test)));
  console.timeEnd(i);
  i += 1;
}

/*
[2, 1, 3]
[2, 4, 1, 3]
[2, 4, 5, 1, 3]
[2, 4, 6, 1, 3]
[2, 4, 4, 1, 3]
[66, 75, 64, 34, 96, 75, 11, 7, 85, 31, 40, 13, 88, 84, 8, 68, 23, 11, 59, 38, 42, 79, 32, 5, 87, 24]
[61, 33, 27, 28, 37, 56, 32, 6, 5, 22, 78, 76, 6, 88, 37, 38, 23, 85, 56, 14, 10, 94, 10, 4, 73, 9, 25, 84, 39, 7, 64, 43, 41, 55, 85, 43, 19, 97, 45, 100, 48, 10, 12, 38, 76, 100, 27]
[51, 41, 43, 40, 84, 75, 87, 66, 33, 70, 76, 59, 62, 32, 47, 16, 95, 20, 84, 33, 14, 74]
[53, 88, 30, 32, 51, 97, 3, 37, 32, 75, 35, 35, 37, 79, 46, 24, 84, 67, 60, 67, 46, 33, 13, 71, 96, 70, 89, 28, 66, 42, 83, 18, 60, 28, 80, 38, 88, 43, 62, 31, 82, 30, 68, 35, 57, 18, 15, 28, 86, 81, 47, 86, 17, 7, 54, 33, 97, 39, 85, 80, 29, 58, 52, 76]
[54, 93, 68, 80, 44, 36, 36, 60, 8, 92, 21, 76, 91, 64, 28, 64, 80, 78, 57, 64, 77, 16, 66, 16, 59, 75, 86, 63, 77, 97, 24, 12, 69, 64, 73, 97, 35, 56, 45, 7, 10, 22, 80, 61, 3, 92, 19, 98, 8, 58, 93, 40, 3, 50, 14, 90, 30, 84, 14, 64, 59, 16, 24, 72, 23, 74, 56, 28, 13, 64]
[65, 33, 5, 87, 83, 15, 20, 49, 23, 3, 68, 4, 34, 51, 46, 48, 14, 52, 96, 23, 4, 53, 28, 14, 86, 10, 97, 50, 39, 51, 34, 9, 96, 55, 54, 3, 36, 88, 28, 25, 38, 27, 15, 88, 23]
[66, 34, 56, 68]
[48, 19, 42, 42, 8, 12, 55, 98, 43, 65, 38, 58, 29, 12, 17, 30, 53, 58, 12, 62, 83, 65, 7, 48, 17, 63, 82, 32, 15, 6, 2, 59, 40, 51, 86, 19, 15, 54, 9, 24, 79, 92, 50, 44, 67, 61, 16, 37, 6, 9, 48, 54, 84, 77, 34, 81, 14, 69, 61, 82, 26, 3, 96, 36, 63, 18, 15, 85]
[78]
[41, 26, 13, 18, 91, 87, 30, 68, 40, 95, 65, 36, 89, 92, 84, 58, 53, 48, 90, 11, 54, 23, 87, 85, 54, 81, 41, 78, 57, 81, 14, 73, 48, 2, 75, 31, 46, 40, 78, 6, 92, 78, 75, 56, 58, 83, 66, 40, 49, 61, 17, 38, 36, 89, 54, 13, 38, 87, 39, 1, 24, 85, 14, 24, 87, 37]
[98, 36, 1, 91, 39, 76, 26, 83, 98, 87, 70, 39, 56, 23, 60, 64, 42, 88, 75, 7, 43, 83, 99, 6, 24, 50, 34, 85, 56, 45, 95]
[60, 23, 54, 17, 67, 82, 43, 62, 91, 87, 95, 15, 49, 75, 83, 3, 58, 75, 11, 4, 62, 39, 79]
[43, 100, 53, 20, 30, 15, 5, 74, 49, 36, 3, 13, 23, 59, 32, 72, 32, 51, 56]
[80, 60, 98, 73, 17, 68, 9, 6, 64, 43, 7, 15, 42, 7, 61, 22, 34, 56, 66, 73, 81, 90]
[74, 57, 87, 61, 74, 38, 41, 91, 35, 3, 3, 53, 43, 20, 62, 27, 2, 49, 45, 46, 8, 59, 98, 9, 75, 58, 40, 42, 43, 78, 64, 60, 47, 57, 29, 71, 92, 46]
[25, 9, 42, 31, 11, 22, 21, 55, 36, 81, 25, 91, 12, 38, 81, 52, 73, 79, 60, 92, 40, 83, 61, 57, 53, 60, 33, 53, 51, 98, 94, 39, 66, 96, 18, 33, 64, 39, 93, 31, 6, 20, 97, 22, 76, 22, 50, 87, 85, 24, 51, 95, 31, 66]
[36, 28, 9, 69, 19, 56, 74, 1, 65, 94, 88, 33, 32, 58, 1, 5, 88, 11, 30, 81, 8, 44, 38, 71, 75, 73, 77, 42, 25, 40, 13, 3, 48, 55, 93, 98, 30, 29, 78]
[54, 35, 12, 36, 37, 23, 93, 79, 11, 86, 46, 91, 21, 64, 94, 100, 38]
[38, 90, 43, 90, 68, 49, 59, 80, 61, 87, 65]
[93, 34, 78, 19, 9, 95, 17, 55, 38, 60, 24, 54, 94, 50, 8, 48, 64, 27, 88, 84, 29, 23, 90, 59, 29, 24, 53, 81, 67, 88, 95, 14, 98, 77, 95, 78, 44, 53]
[33, 44, 83, 46, 93, 23, 31, 60, 64, 60, 12, 54, 25, 70, 33, 57, 77, 73, 19, 96, 76, 26, 91, 54, 43, 30, 4, 40, 31, 21, 89, 42, 77, 62, 5, 96]
[91, 69, 7, 91, 85, 9, 28, 63, 29, 43, 91, 95, 21]
[71, 44, 97, 5, 84, 99, 58, 84, 87, 83, 5, 54, 31, 88, 84, 22, 57, 71, 52, 57, 35, 24, 31, 18, 37, 21, 76, 70, 40, 27, 67, 47, 1, 33, 97, 32, 93, 39, 73, 36, 27, 28, 10, 92, 13, 7, 19, 65, 16, 91, 67, 4, 72, 57, 48, 10, 58, 99]
[98, 19, 34, 39, 61, 95, 26, 94, 45, 78, 91, 45]
[50, 78, 28, 84, 21]
[34, 43, 57, 69, 82, 88, 6, 4, 50, 18, 8, 26, 51, 45, 72, 44, 13, 34, 100, 77, 42, 69, 24, 90, 39, 15, 2, 69, 31, 96, 49, 86, 95, 56, 3, 68, 34, 67, 19, 52, 39, 47, 90, 51, 97, 79, 51, 42, 63, 49, 93, 75, 76, 87, 91, 37, 21, 64, 29, 39, 88, 15, 14, 33]
[12, 90, 77, 73, 87, 6, 83, 75, 49, 56, 63, 88, 40, 56, 81, 45, 31, 97, 69, 24, 38, 3, 87, 68, 63, 27, 55, 1, 16, 15, 80, 40, 8, 23, 33, 22, 32, 70, 28, 7, 19, 60, 77, 62, 40, 72, 48, 75, 1, 1, 64, 39, 46]
[10, 92, 85, 78, 20, 32, 93, 98, 51, 81, 78, 49, 74, 73, 75, 100, 33, 88, 95, 69, 52, 54, 97, 88, 9, 42, 20, 17, 8, 36, 73, 56, 50, 67, 91, 53, 78, 93, 36, 19, 61, 6, 69, 40, 13, 84, 29, 10, 95, 19, 58, 56, 31, 41, 14, 33, 27, 74, 53]
[18, 23, 72, 13, 20, 48, 28, 71, 16, 82, 60, 21, 3, 94, 10, 24, 9, 81, 75, 95, 81, 66, 77, 68, 46, 8, 92]
[73, 62, 43, 56, 78, 87, 44, 2, 92, 88, 34, 74, 73, 70, 90, 57, 65, 36, 12, 81, 13, 91, 40, 43, 32, 54, 60, 3, 4, 65, 72, 73, 78, 62, 42, 28, 8, 57, 63, 69, 19, 13, 66, 11, 63, 47, 74, 95, 63, 55, 17, 29, 99]
*/